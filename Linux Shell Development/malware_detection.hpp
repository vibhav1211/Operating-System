#ifndef MALWARE_DETECTION_HPP
#define MALWARE_DETECTION_HPP

#include <iostream>
#include <map>
#include <vector>

struct process
{
    int pid;
    int children_count;
    int total_children = -1;
    int parent;
    double process_time;
    double process_time_children = -1;
    std::vector<int> children;
};

int pgetppid(int pid);

double get_process_time(int pid);

void print_parents(int pid);

std::vector<int> get_parents(int pid);

int get_total_child(int pid, std::map<int, process> &malware_detection);

double get_total_process_time(int pid, std::map<int, process> &malware_detection);

std::map<int, process> create_process_info();

void find_malware(int pid);

void detect(std::vector<std::string> args);

#endif
